{% extends 'base.html.twig' %}

{% block title %}Mes trajets proposés{% endblock %}

{% block body %}
<section class="section-box">
  <h2 class="text-center text-success mb-4">🚘 Mes trajets en tant que conducteur</h2>

  {% if covoiturages is empty %}
    <p class="text-center text-muted">Aucun trajet proposé pour l’instant.</p>
  {% else %}
    <div class="table-responsive">
      <table class="table table-bordered table-striped align-middle text-center">
        <thead class="table-success">
          <tr>
            <th>Participants</th>
            <th>Date</th>
            <th>Départ</th>
            <th>Arrivée</th>
            <th>Places restantes</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for c in covoiturages %}
            <tr>
              <td>
                {% if c.participants is empty %}
                  <span class="text-muted">Aucun</span>
                {% else %}
                  <ul class="list-unstyled mb-0">
                    {% for participant in c.participants %}
                      <li>{{ participant.username }}</li>
                    {% endfor %}
                  </ul>
                {% endif %}
              </td>
              <td>{{ c.dateDepart|date('d/m/Y') }}</td>
              <td>{{ c.lieuDepart }}</td>
              <td>{{ c.lieuArrivee }}</td>
              <td>{{ c.nbPlace }}</td>
              <td>
                <span class="badge bg-{{ c.statut.value == 'PUBLIÉ' ? 'success' : 'secondary' }}">
                  {{ c.statut.value|capitalize }}
                </span>
              </td>
              <td>
                <a href="{{ path('covoiturage_edit', {'id': c.id}) }}" class="btn btn-outline-primary btn-sm">✏️</a>
                <a href="{{ path('covoiturage_delete', {'id': c.id}) }}" class="btn btn-outline-danger btn-sm"
                   onclick="return confirm('Es-tu sûr de vouloir supprimer ce trajet ?')">🗑️</a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}
</section>
{% endblock %}
